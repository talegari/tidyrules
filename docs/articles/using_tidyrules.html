<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using tidyrules • tidyrules</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using tidyrules">
<meta property="og:description" content="tidyrules">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyrules</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/using_tidyrules.html">Using tidyrules</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/talegari/tidyrules/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using tidyrules</h1>
                        <h4 data-toc-skip class="author">Srikanth KS,
Amith Kumar UR</h4>
            
            <h4 data-toc-skip class="date">2024-06-28</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/talegari/tidyrules/blob/HEAD/vignettes/articles/using_tidyrules.Rmd" class="external-link"><code>vignettes/articles/using_tidyrules.Rmd</code></a></small>
      <div class="hidden name"><code>using_tidyrules.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="abstract">Abstract<a class="anchor" aria-label="anchor" href="#abstract"></a>
</h2>
<blockquote>
<p><a href="https://cran.r-project.org/package=tidyrules" class="external-link">tidyrules</a>
<a href="https://www.r-project.org/" class="external-link">R</a> <a href="https://cran.r-project.org/" class="external-link">package</a> provides a framework to
work with decision rules. Rules can be extracted from supported models,
augmented with (custom) metrics using validation data, manipulated using
standard dataframe operations, reordered and pruned based on a metric,
predict on unseen (test) data. Utilities include; Creating a rulelist
manually, Exporting a rulelist as a SQL case statement and so on. The
package offers two classes; rulelist and rulelset based on
dataframe.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="schematic">Schematic<a class="anchor" aria-label="anchor" href="#schematic"></a>
</h2>
<p><img src="tidyrules_schematic.png"></p>
</div>
<div class="section level2">
<h2 id="about">About<a class="anchor" aria-label="anchor" href="#about"></a>
</h2>
<p>This document provides a working example of a classification problem
where the functionality of package is showcased. We use
<code><a href="https://modeldata.tidymodels.org/reference/attrition.html" class="external-link">modeldata::attrition</a></code> dataset where <code>Attrition</code>
column is the binary dependent variable.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/talegari/tidyrules" class="external-link">"tidyrules"</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">att</span> <span class="op">=</span> <span class="fu">modeldata</span><span class="fu">::</span><span class="va"><a href="https://modeldata.tidymodels.org/reference/attrition.html" class="external-link">attrition</a></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">valid_index</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">att</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">att_train</span> <span class="op">=</span> <span class="va">att</span><span class="op">[</span><span class="op">!</span><span class="va">valid_index</span>, <span class="op">]</span> <span class="co"># nrow: 742</span></span>
<span><span class="va">att_valid</span> <span class="op">=</span> <span class="va">att</span><span class="op">[</span><span class="va">valid_index</span>, <span class="op">]</span>  <span class="co"># nrow: 728</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">att</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 1,470</span></span>
<span><span class="co">## Columns: 31</span></span>
<span><span class="co">## $ Age                      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 41, 49, 37, 33, 27, 32, 59, 30, 38, 36, 35, 2…</span></span>
<span><span class="co">## $ Attrition                <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Yes, No, Yes, No, No, No, No, No, No, No, No,…</span></span>
<span><span class="co">## $ BusinessTravel           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Travel_Rarely, Travel_Frequently, Travel_Rare…</span></span>
<span><span class="co">## $ DailyRate                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1102, 279, 1373, 1392, 591, 1005, 1324, 1358,…</span></span>
<span><span class="co">## $ Department               <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Sales, Research_Development, Research_Develop…</span></span>
<span><span class="co">## $ DistanceFromHome         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 8, 2, 3, 2, 2, 3, 24, 23, 27, 16, 15, 26, …</span></span>
<span><span class="co">## $ Education                <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> College, Below_College, College, Master, Belo…</span></span>
<span><span class="co">## $ EducationField           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Life_Sciences, Life_Sciences, Other, Life_Sci…</span></span>
<span><span class="co">## $ EnvironmentSatisfaction  <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> Medium, High, Very_High, Very_High, Low, Very…</span></span>
<span><span class="co">## $ Gender                   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Female, Male, Male, Female, Male, Male, Femal…</span></span>
<span><span class="co">## $ HourlyRate               <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 94, 61, 92, 56, 40, 79, 81, 67, 44, 94, 84, 4…</span></span>
<span><span class="co">## $ JobInvolvement           <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> High, Medium, Medium, High, High, High, Very_…</span></span>
<span><span class="co">## $ JobLevel                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 2, 2, 1, 1, 1, 1, 1, 1, 3, 2, 1, 2, 1, 1, 1, …</span></span>
<span><span class="co">## $ JobRole                  <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Sales_Executive, Research_Scientist, Laborato…</span></span>
<span><span class="co">## $ JobSatisfaction          <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> Very_High, Medium, High, High, Medium, Very_H…</span></span>
<span><span class="co">## $ MaritalStatus            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Single, Married, Single, Married, Married, Si…</span></span>
<span><span class="co">## $ MonthlyIncome            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 5993, 5130, 2090, 2909, 3468, 3068, 2670, 269…</span></span>
<span><span class="co">## $ MonthlyRate              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 19479, 24907, 2396, 23159, 16632, 11864, 9964…</span></span>
<span><span class="co">## $ NumCompaniesWorked       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8, 1, 6, 1, 9, 0, 4, 1, 0, 6, 0, 0, 1, 0, 5, …</span></span>
<span><span class="co">## $ OverTime                 <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> Yes, No, Yes, Yes, No, No, Yes, No, No, No, N…</span></span>
<span><span class="co">## $ PercentSalaryHike        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 11, 23, 15, 11, 12, 13, 20, 22, 21, 13, 13, 1…</span></span>
<span><span class="co">## $ PerformanceRating        <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> Excellent, Outstanding, Excellent, Excellent,…</span></span>
<span><span class="co">## $ RelationshipSatisfaction <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> Low, Very_High, Medium, High, Very_High, High…</span></span>
<span><span class="co">## $ StockOptionLevel         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 0, 1, 0, 0, 1, 0, 3, 1, 0, 2, 1, 0, 1, 1, 0, …</span></span>
<span><span class="co">## $ TotalWorkingYears        <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 8, 10, 7, 8, 6, 8, 12, 1, 10, 17, 6, 10, 5, 3…</span></span>
<span><span class="co">## $ TrainingTimesLastYear    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 0, 3, 3, 3, 3, 2, 3, 2, 2, 3, 5, 3, 1, 2, 4, …</span></span>
<span><span class="co">## $ WorkLifeBalance          <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span> Bad, Better, Better, Better, Better, Good, Go…</span></span>
<span><span class="co">## $ YearsAtCompany           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 6, 10, 0, 8, 2, 7, 1, 1, 9, 7, 5, 9, 5, 2, 4,…</span></span>
<span><span class="co">## $ YearsInCurrentRole       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 4, 7, 0, 7, 2, 7, 0, 0, 7, 7, 4, 5, 2, 2, 2, …</span></span>
<span><span class="co">## $ YearsSinceLastPromotion  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 0, 1, 0, 3, 2, 3, 0, 0, 1, 7, 0, 0, 4, 1, 0, …</span></span>
<span><span class="co">## $ YearsWithCurrManager     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 5, 7, 0, 0, 2, 6, 0, 0, 8, 7, 3, 8, 3, 2, 3, …</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="tidy">Tidy<a class="anchor" aria-label="anchor" href="#tidy"></a>
</h2>
<p><code>tidy</code> generic creates <code>rulelist</code> from a
supported model fit. <code>rulelist</code> class is fundamental data
structure which offers many methods such as <code>predict</code>,
<code>augment</code> and so on. A <code>rulelist</code> is a dataframe
with some extra attributes. The order of rows of the dataframe defines
the order of preference of rules.</p>
<p><code>tidy</code> supports these model fits:</p>
<ul>
<li>
<code>C5</code> rule-based model (classification)</li>
<li>
<code>rpart</code> tree (classification / regression)</li>
<li>
<code>party</code> tree (classification / regression)</li>
<li>
<code>cubist</code> tree (regression)</li>
</ul>
<p>Lets build a C5 model and then extract a rulelist:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_c5</span> <span class="op">=</span> <span class="fu">C50</span><span class="fu">::</span><span class="fu"><a href="https://topepo.github.io/C5.0/reference/C5.0.html" class="external-link">C5.0</a></span><span class="op">(</span><span class="va">Attrition</span> <span class="op">~</span><span class="va">.</span>, data <span class="op">=</span> <span class="va">att_train</span>, rules <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">model_c5</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Call:</span></span>
<span><span class="co">## C5.0.formula(formula = Attrition ~ ., data = att_train, rules = TRUE)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Rule-Based Model</span></span>
<span><span class="co">## Number of samples: 742 </span></span>
<span><span class="co">## Number of predictors: 30 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Number of Rules: 19 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Non-standard options: attempt to group attributes</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy_c5</span> <span class="op">=</span> <span class="fu"><a href="../reference/tidy.html">tidy</a></span><span class="op">(</span><span class="va">model_c5</span><span class="op">)</span></span>
<span><span class="va">tidy_c5</span></span>
<span><span class="co">## ---- Rulelist --------------------------------</span></span>
<span><span class="co">## ▶ Keys: trial_nbr</span></span>
<span><span class="co">## ▶ Number of distinct keys: 1</span></span>
<span><span class="co">## ▶ Number of rules: 19</span></span>
<span><span class="co">## ▶ Model type: C5</span></span>
<span><span class="co">## ▶ Estimation type: classification</span></span>
<span><span class="co">## ▶ Is validation data set: FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    rule_nbr trial_nbr LHS                         RHS   support confidence  lift</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1         1 ( Age &gt; 26 ) &amp; ( Environme… No        189      0.963   1.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        2         1 ( Age &gt; 26 ) &amp; ( Environme… No        244      0.951   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        3         1 ( BusinessTravel == 'Non-T… No         74      0.947   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4         1 ( Age &lt;= 31 ) &amp; ( Educatio… Yes        12      0.929   5.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        5         1 ( JobSatisfaction %in% c('… No        157      0.924   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        6         1 ( Age &gt; 26 ) &amp; ( Environme… No        351      0.924   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        7         1 ( EnvironmentSatisfaction … Yes         8      0.9     5.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        8         1 ( OverTime == 'Yes' ) &amp; ( … Yes         8      0.9     5.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        9         1 ( BusinessTravel %in% c('T… Yes         8      0.9     5.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       10         1 ( EnvironmentSatisfaction … Yes         7      0.889   5.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>       11         1 ( JobInvolvement == 'Low' … Yes         7      0.889   5.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>       12         1 ( OverTime == 'No' )        No        516      0.888   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>       13         1 ( EnvironmentSatisfaction … Yes         5      0.857   5  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>       14         1 ( MaritalStatus %in% c('Ma… Yes        17      0.842   4.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>       15         1 ( NumCompaniesWorked &gt; 6 )… Yes        10      0.833   4.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>       16         1 ( EnvironmentSatisfaction … Yes         8      0.8     4.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>       17         1 ( Age &lt;= 26 ) &amp; ( Environm… Yes        22      0.75    4.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>       18         1 ( EnvironmentSatisfaction … Yes         9      0.636   3.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span>       19         1 ( EnvironmentSatisfaction … Yes        28      0.633   3.7</span></span>
<span><span class="co">## ----------------------------------------------</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="rulelist">Rulelist<a class="anchor" aria-label="anchor" href="#rulelist"></a>
</h2>
<p>A rulelist is expected to have these mandatory columns:</p>
<ul>
<li>
<code>rule_nbr</code>: Something that identifies a rule uniquely per
<code>keys</code>. Typically, an integer vector starting from 1.</li>
<li>
<code>LHS</code>: A character vector of R-parsable strings</li>
<li>
<code>RHS</code>: factor (for classification), numeric (for
regression) or character vector of R-parsable strings (to be
evaluated)</li>
</ul>
<p><code>trial_nbr</code> is a key. <code>C5</code> model builds
multiple boosting iterations indexed by <code>trial_nbr</code> (default
is set to 1). <code>rule_nbr</code>’s start from 1 for each
<code>trial_nbr</code>. In general, <code>keys</code> columns along with
<code>rule_nbr</code> column should be unique.</p>
<p>Attribute <code>estimation_type</code> is central to further methods
where metrics get computed. At this moment, the package supports these:
<code>classification</code>, <code>regression</code>.</p>
<p>The rulelist (obtained from <code>C5</code> model) ordered by
<code>confidence</code> column, by default.</p>
<p>A rulelist can be either created using <code>tidy</code> on a
supported model or a from a dataframe using
<code>as_rulelist</code>.</p>
<blockquote>
<p>☺☺☺ rulelist is simply a dataframe with some attributes. Manipulate
them with standard dataframe operations (<code>dplyr</code>,
<code>data.table</code> …). <code><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">tibble::as_tibble</a></code> or
<code>as.data.frame</code> will convert to a tibble/dataframe (with
attributes). <code>as_rulelist</code> can be used to convert to a
rulelist.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="predict">Predict<a class="anchor" aria-label="anchor" href="#predict"></a>
</h2>
<p>The mainstay of package is the <code>predict</code> method of the
rulelist class. <code>predict</code> provides the first rule (in the
order as per the rulelist) that is applicable for a observation/row in
the test data. If a row is not <em>covered</em> by any rule, then
<code>rule_nbr</code> is missing.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tidy_c5</span>, <span class="va">att_valid</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 728 × 3</span></span></span>
<span><span class="co">##    row_nbr trial_nbr rule_nbr</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>       1         1        8</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>       2         1        6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>       3         1        6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>       4         1        6</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>       5         1       <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       6         1       12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>       7         1       12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       8         1        5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>       9         1       12</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      10         1        1</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 718 more rows</span></span></span></code></pre>
<blockquote>
<p>☺☺☺ To know all rules applicable for a row, use argument
<code>multiple = TRUE</code>. Alternately, <code>predict</code> on a
ruleset always yields all rules applicable per row.</p>
</blockquote>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tidy_c5</span>, <span class="va">att_valid</span>, multiple <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 728 × 3</span></span></span>
<span><span class="co">##    row_nbr trial_nbr rule_nbr </span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;list&gt;</span>   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>       1         1 <span style="color: #949494;">&lt;int [2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>       2         1 <span style="color: #949494;">&lt;int [1]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>       3         1 <span style="color: #949494;">&lt;int [1]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>       4         1 <span style="color: #949494;">&lt;int [2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>       5         1 <span style="color: #949494;">&lt;int [1]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       6         1 <span style="color: #949494;">&lt;int [1]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>       7         1 <span style="color: #949494;">&lt;int [1]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       8         1 <span style="color: #949494;">&lt;int [2]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>       9         1 <span style="color: #949494;">&lt;int [1]&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>      10         1 <span style="color: #949494;">&lt;int [3]&gt;</span></span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 718 more rows</span></span></span></code></pre>
</div>
<div class="section level2">
<h2 id="setters">Setters<a class="anchor" aria-label="anchor" href="#setters"></a>
</h2>
<ul>
<li><p><code>set_validation_data</code>: Setting (or removing)
validation data adds a validation data to a rulelist which gets used for
<code>augment</code>, <code>calculate</code> and other methods.</p></li>
<li><p><code>set_keys</code>: Sets (or removes) keys.</p></li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy_c5</span> <span class="op">=</span></span>
<span>  <span class="va">tidy_c5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/set_validation_data.html">set_validation_data</a></span><span class="op">(</span><span class="va">att_valid</span>, y_name <span class="op">=</span> <span class="st">"Attrition"</span>, weight <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/set_keys.html">set_keys</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tidy_c5</span></span></code></pre></div>
<pre><code><span><span class="co">## ---- Rulelist --------------------------------</span></span>
<span><span class="co">## ▶ Keys: NULL</span></span>
<span><span class="co">## ▶ Number of rules: 19</span></span>
<span><span class="co">## ▶ Model type: C5</span></span>
<span><span class="co">## ▶ Estimation type: classification</span></span>
<span><span class="co">## ▶ Is validation data set: TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    rule_nbr trial_nbr LHS                         RHS   support confidence  lift</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1         1 ( Age &gt; 26 ) &amp; ( Environme… No        189      0.963   1.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        2         1 ( Age &gt; 26 ) &amp; ( Environme… No        244      0.951   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        3         1 ( BusinessTravel == 'Non-T… No         74      0.947   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4         1 ( Age &lt;= 31 ) &amp; ( Educatio… Yes        12      0.929   5.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        5         1 ( JobSatisfaction %in% c('… No        157      0.924   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        6         1 ( Age &gt; 26 ) &amp; ( Environme… No        351      0.924   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        7         1 ( EnvironmentSatisfaction … Yes         8      0.9     5.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        8         1 ( OverTime == 'Yes' ) &amp; ( … Yes         8      0.9     5.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        9         1 ( BusinessTravel %in% c('T… Yes         8      0.9     5.3</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       10         1 ( EnvironmentSatisfaction … Yes         7      0.889   5.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>       11         1 ( JobInvolvement == 'Low' … Yes         7      0.889   5.2</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>       12         1 ( OverTime == 'No' )        No        516      0.888   1.1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>       13         1 ( EnvironmentSatisfaction … Yes         5      0.857   5  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>       14         1 ( MaritalStatus %in% c('Ma… Yes        17      0.842   4.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>       15         1 ( NumCompaniesWorked &gt; 6 )… Yes        10      0.833   4.9</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>       16         1 ( EnvironmentSatisfaction … Yes         8      0.8     4.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>       17         1 ( Age &lt;= 26 ) &amp; ( Environm… Yes        22      0.75    4.4</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>       18         1 ( EnvironmentSatisfaction … Yes         9      0.636   3.7</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span>       19         1 ( EnvironmentSatisfaction … Yes        28      0.633   3.7</span></span>
<span><span class="co">## ----------------------------------------------</span></span></code></pre>
<blockquote>
<p>☺☺☺ Setting weight argument (other than 1 which means equal weigth)
leads to calculating weighted metrics.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="augment">Augment<a class="anchor" aria-label="anchor" href="#augment"></a>
</h2>
<p><code>augment</code> adds metrics related to validation data in a new
column ‘augmented_stats’.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tidy_c5</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/augment.html">augment</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">tidytable</span><span class="fu">::</span><span class="fu"><a href="https://markfairbanks.github.io/tidytable/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span>names_sep <span class="op">=</span> <span class="st">"__"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 19</span></span>
<span><span class="co">## Columns: 10</span></span>
<span><span class="co">## $ rule_nbr                    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,…</span></span>
<span><span class="co">## $ trial_nbr                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …</span></span>
<span><span class="co">## $ LHS                         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "( Age &gt; 26 ) &amp; ( EnvironmentSatisfaction …</span></span>
<span><span class="co">## $ RHS                         <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> No, No, No, Yes, No, No, Yes, Yes, Yes, Ye…</span></span>
<span><span class="co">## $ support                     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 189, 244, 74, 12, 157, 351, 8, 8, 8, 7, 7,…</span></span>
<span><span class="co">## $ confidence                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.9634000, 0.9512000, 0.9474000, 0.9285714…</span></span>
<span><span class="co">## $ lift                        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.2, 1.1, 1.1, 5.4, 1.1, 1.1, 5.3, 5.3, 5.…</span></span>
<span><span class="co">## $ augmented_stats__support    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 212, 236, 76, 13, 153, 306, 10, 17, 10, 6,…</span></span>
<span><span class="co">## $ augmented_stats__confidence <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.89622642, 0.91101695, 0.88157895, 0.4615…</span></span>
<span><span class="co">## $ augmented_stats__lift       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.0285265, 1.0455004, 1.0117168, 3.5880893…</span></span></code></pre>
<blockquote>
<p>☺☺☺ If augmented metrics differ from train data metrics, then it
could indicate drift in the data!</p>
</blockquote>
<blockquote>
<p>☺☺☺ <code>augment</code> also supports custom metrics in
<code><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">dplyr::summarise</a></code> syntax!</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="plot">Plot<a class="anchor" aria-label="anchor" href="#plot"></a>
</h2>
<p>Plotting a rulelist as a heatmap helps in understanding these
things:</p>
<ul>
<li>Cluster of rows which are <em>covered</em> by same set of rules
(with hclust)</li>
<li>Cluster rules based on the common rows they *cover (with
hclust)</li>
<li>Row and column labels with dependent variable help us identify
potential outliers and potential under-fitting.</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tidy_c5</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_tidyrules_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
<blockquote>
<p>☺☺☺ distance metric for rules is <code>jaccard</code> and distance
metric for row clusters is <code>euclidean</code>. Former can be changed
to any distance supported by <code>proxy</code> package or a custom
distance function for custom insight!</p>
</blockquote>
<blockquote>
<p>☺☺☺ When you have a rulelist which is a combination of multiple
classifiers, rule clusters quickly reveal ‘correlated’ rules! The ones
which cover almost same rows, but LHS of each reads different!</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="calculate">Calculate<a class="anchor" aria-label="anchor" href="#calculate"></a>
</h2>
<p><code>calculate</code> computes cumulative metrics (as rules are
applied in the row order) depending on attribute
<code>estimation_type</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate.html">calculate</a></span><span class="op">(</span><span class="va">tidy_c5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 19 × 4</span></span></span>
<span><span class="co">##    rule_nbr cumulative_coverage cumulative_overlap cumulative_accuracy</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>        1                 212                  0               0.896</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        2                 277                171               0.910</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        3                 323                187               0.895</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4                 336                187               0.878</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        5                 413                217               0.877</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>        6                 495                301               0.875</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>        7                 500                306               0.866</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>        8                 515                308               0.852</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>        9                 525                308               0.844</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       10                 527                312               0.843</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>       11                 529                314               0.841</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>       12                 686                456               0.848</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>       13                 687                460               0.849</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>       14                 697                462               0.845</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>       15                 702                466               0.840</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>       16                 702                470               0.840</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>       17                 710                480               0.835</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>       18                 710                484               0.835</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span>       19                 725                495               0.826</span></span></code></pre>
<blockquote>
<p>☺☺☺ <code>calculate</code> allows a custom metric of your choice!</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="reorder">Reorder<a class="anchor" aria-label="anchor" href="#reorder"></a>
</h2>
<p><code>reorder</code> intends to reorder the order of rules. At the
moment, the greedy implementation adds one rule at a time to a new
rulelist (from the input rulelist) such that a metric (see
<code>calculate</code>) is maximixed/minimized.</p>
<p>Suppose, you wanted to find a smaller ruleset with least overlap that
would still cover 80% of the validation_data. Then,</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/reorder.html">reorder</a></span><span class="op">(</span><span class="va">tidy_c5</span>,</span>
<span>        metric <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"cumulative_overlap"</span>,</span>
<span>                   <span class="st">"cumulative_coverage"</span>,</span>
<span>                   <span class="st">"cumulative_accuracy"</span></span>
<span>                   <span class="op">)</span>,</span>
<span>        minimize <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://markfairbanks.github.io/tidytable/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>rel_cum_overlap <span class="op">=</span> </span>
<span>           <span class="va">cumulative_overlap</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cumulative_overlap</span><span class="op">)</span>,</span>
<span>         rel_cum_coverage <span class="op">=</span> </span>
<span>           <span class="va">cumulative_coverage</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">cumulative_coverage</span><span class="op">)</span></span>
<span>         <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://markfairbanks.github.io/tidytable/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">rule_nbr</span>, <span class="va">LHS</span>, <span class="va">RHS</span>,</span>
<span>         <span class="va">rel_cum_overlap</span>, <span class="va">rel_cum_coverage</span>,</span>
<span>         <span class="va">cumulative_accuracy</span></span>
<span>         <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ⠙ Reordering ... 4 done (1.4/s) | 2.8s</span></span></code></pre>
<pre><code><span><span class="co">## ⠹ Reordering ... 5 done (1.3/s) | 3.7s</span></span></code></pre>
<pre><code><span><span class="co">## ⠸ Reordering ... 8 done (1.1/s) | 7s</span></span></code></pre>
<pre><code><span><span class="co">## ⠼ Reordering ... 11 done (1.1/s) | 10.4s</span></span></code></pre>
<pre><code><span><span class="co">## ⠴ Reordering ... 14 done (1/s) | 13.4s</span></span></code></pre>
<pre><code><span><span class="co">## ⠦ Reordering ... 18 done (1.1/s) | 15.9s</span></span></code></pre>
<pre><code><span><span class="co">## ⠦ Reordering ... 19 done (1.2/s) | 16.1s</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## ---- Rulelist --------------------------------</span></span>
<span><span class="co">## ▶ Keys: NULL</span></span>
<span><span class="co">## ▶ Number of rules: 19</span></span>
<span><span class="co">## ▶ Model type: C5</span></span>
<span><span class="co">## ▶ Estimation type: classification</span></span>
<span><span class="co">## ▶ Is validation data set: TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##    rule_nbr LHS       RHS   rel_cum_overlap rel_cum_coverage cumulative_accuracy</span></span>
<span><span class="co">##       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>       16 ( Enviro… Yes            0                0.012<span style="text-decoration: underline;">4</span>               0.556</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>        9 ( Busine… Yes            0                0.026<span style="text-decoration: underline;">2</span>               0.474</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>        8 ( OverTi… Yes            0                0.049<span style="text-decoration: underline;">7</span>               0.444</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>        4 ( Age &lt;=… Yes            0                0.067<span style="text-decoration: underline;">6</span>               0.449</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>        3 ( Busine… No             0.010<span style="text-decoration: underline;">1</span>           0.166                0.708</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>       15 ( NumCom… Yes            0.014<span style="text-decoration: underline;">1</span>           0.175                0.677</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>       14 ( Marita… Yes            0.022<span style="text-decoration: underline;">2</span>           0.189                0.672</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>       13 ( Enviro… Yes            0.024<span style="text-decoration: underline;">2</span>           0.196                0.655</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>       12 ( OverTi… No             0.190            0.819                0.854</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>       17 ( Age &lt;=… Yes            0.208            0.832                0.846</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">11</span>       11 ( JobInv… Yes            0.214            0.833                0.844</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">12</span>       10 ( Enviro… Yes            0.220            0.836                0.843</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">13</span>        7 ( Enviro… Yes            0.232            0.836                0.843</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">14</span>        6 ( Age &gt; … No             0.638            0.942                0.837</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">15</span>       18 ( Enviro… Yes            0.646            0.943                0.836</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">16</span>        5 ( JobSat… No             0.780            0.950                0.837</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">17</span>        2 ( Age &gt; … No             0.927            0.972                0.833</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">18</span>       19 ( Enviro… Yes            0.949            0.993                0.824</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">19</span>        1 ( Age &gt; … No             1                1                    0.822</span></span>
<span><span class="co">## ----------------------------------------------</span></span></code></pre>
<p>we infer that first 9 rules (~ 20% overlap) in the reordered rulelist
would do still ensuring an accuracy of 85% !</p>
<blockquote>
<p>☺☺☺ In the above code, 2nd metric onwards are used to break ties!
(similar to <code><a href="https://rdrr.io/r/base/order.html" class="external-link">base::order</a></code>)</p>
</blockquote>
<blockquote>
<p>☺☺☺ Reordering changes the decision bourdaries of your fit! It is a
post-hoc method to overlap the <em>learnt</em> rules to optimize for the
metric you need! But remember, greedy optimization method does guarantee
the global minima (maxima)!</p>
</blockquote>
<blockquote>
<p>☺☺☺ <code>reorder</code> comes with a <code>init = k</code> argument
which leaves a predecided top k rules in their order and reorders only
bottom ones. This might be required when policy layer needs to be
incorporated into the rule engine!</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="prune">Prune<a class="anchor" aria-label="anchor" href="#prune"></a>
</h2>
<p><code>prune</code> suggests k th rule to stop at based on some
stopping criteria.</p>
<p>Suppose, we seek to find a smaller rulelist with maximum possible
accuracy with a minimum (relative) coverage of 70% and (relative)
overlap not more than half the number of rows. Then,</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prune_suggestion</span> <span class="op">=</span> </span>
<span>  <span class="fu"><a href="../reference/reorder.html">reorder</a></span><span class="op">(</span><span class="va">tidy_c5</span>, <span class="st">"cumulative_accuracy"</span>, minimize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/prune.html">prune</a></span><span class="op">(</span>stop_expr_string <span class="op">=</span> <span class="st">"relative__cumulative_coverage &gt;= 0.7 &amp; cumulative_overlap &lt;= 728/2"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## ⠙ Reordering ... 4 done (1.5/s) | 2.6s</span></span></code></pre>
<pre><code><span><span class="co">## ⠹ Reordering ... 7 done (1.2/s) | 5.8s</span></span></code></pre>
<pre><code><span><span class="co">## ⠸ Reordering ... 10 done (1.1/s) | 9.2s</span></span></code></pre>
<pre><code><span><span class="co">## ⠼ Reordering ... 13 done (1/s) | 12.4s</span></span></code></pre>
<pre><code><span><span class="co">## ⠴ Reordering ... 16 done (1.1/s) | 15s</span></span></code></pre>
<pre><code><span><span class="co">## ⠴ Reordering ... 19 done (1.2/s) | 16.1s</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prune_suggestion</span></span></code></pre></div>
<pre><code><span><span class="co">## ── Prune Suggestion ────────────────────────────────────────────────────────────</span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Keep first 4 out of 19</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Metrics after 4 rules:</span></span></code></pre>
<pre><code><span><span class="co">## </span></span></code></pre>
<pre><code><span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Run `plot(x)` for details; `x$pruned` to get pruned rulelist</span></span></code></pre>
<pre><code><span><span class="co">## ────────────────────────────────────────────────────────────────────────────────</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prune_suggestion</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_tidyrules_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prune_suggestion</span><span class="op">$</span><span class="va">pruned</span></span></code></pre></div>
<pre><code><span><span class="co">## ---- Rulelist --------------------------------</span></span>
<span><span class="co">## ▶ Keys: NULL</span></span>
<span><span class="co">## ▶ Number of rules: 4</span></span>
<span><span class="co">## ▶ Model type: C5</span></span>
<span><span class="co">## ▶ Estimation type: classification</span></span>
<span><span class="co">## ▶ Is validation data set: TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   rule_nbr trial_nbr LHS      RHS   support confidence  lift cumulative_accuracy</span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>        4         1 ( Age &lt;… Yes        12      0.929   5.4               0.462</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>        5         1 ( JobSa… No        157      0.924   1.1               0.865</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>        6         1 ( Age &gt;… No        351      0.924   1.1               0.886</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span>       12         1 ( OverT… No        516      0.888   1.1               0.883</span></span>
<span><span class="co">## ----------------------------------------------</span></span></code></pre>
<blockquote>
<p>☺☺☺ <code>prune</code> is powerful when combined with
<code>reorder</code>! While <code>reorder</code> chases a metric,
<code>prune</code> takes care of constraints! This might lead to small
rulelists, very good for explainability!</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="out-in-the-wild">Out in the Wild<a class="anchor" aria-label="anchor" href="#out-in-the-wild"></a>
</h2>
<p>Use <code>to_sql_case</code> to get SQL case when code chunk from a
rulelist.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/to_sql_case.html">to_sql_case</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tidy_c5</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>CASE
WHEN (Age &gt; 26)
    AND (EnvironmentSatisfaction IN ( 'Medium', 'High', 'Very_High' ))
    AND (PercentSalaryHike &lt;= 17)
    AND (StockOptionLevel &gt; 0)
    AND (StockOptionLevel &lt;= 2)
    AND (TotalWorkingYears &gt; 2) THEN
   'No'
WHEN (Age &gt; 26)
    AND (EnvironmentSatisfaction IN ( 'Medium', 'High', 'Very_High' ))
    AND (StockOptionLevel &gt; 0)
    AND (YearsAtCompany &gt; 3) THEN
   'No'
WHEN (BusinessTravel = 'Non-Travel') THEN
   'No'
WHEN (Age &lt;= 31)
    AND (EducationField = 'Technical_Degree')
    AND (StockOptionLevel &lt;= 0) THEN
   'Yes'
WHEN (JobSatisfaction IN ( 'Low', 'Medium', 'High' ))
    AND (MonthlyIncome &gt; 3210)
    AND (RelationshipSatisfaction IN ( 'Medium', 'High', 'Very_High' ))
    AND (TrainingTimesLastYear &gt; 2) THEN
   'No'
ELSE
   NULL
END AS output</code></pre>
</div>
<div class="section level2">
<h2 id="more">More<a class="anchor" aria-label="anchor" href="#more"></a>
</h2>
<ul>
<li>We will add <code>tidy</code> support to more models. Your
contributions are welcome!</li>
<li>Ideas for methods are welcome!</li>
</ul>
<p>✔ `For dev and issues, reach us at <a href="http://github.com/talegari/tidyrules" class="external-link uri">http://github.com/talegari/tidyrules</a></p>
<p>✔ ‘master’ branch always holds the ‘tested’ dev code!</p>
<p>✔ Get the latest stable version from CRAN!</p>
<p>Yours truly,<br>
Amith (ಅಮಿತ್) and Srikanth (ಶ್ರೀಕಾಂತ)</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Srikanth Komala Sheshachala, Amith Kumar Ullur Raghavendra.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
